// -*- mode: javascript; tab-width: 4; c-basic-offset: 4; indent-tabs-mode: nil; -*-

var jit = tame.require ("tamejs/lib/jit");
var slots = {};
var n = 40;
var assert = require ("assert");

jit.compile (function x () {
    
	console.log ("FOO!");
	while (i < n) {


        await (function (x) {
		    setTimeout (future (), 1); 
		    setTimeout (future (), 2); 
        });

		slots[i] = 1;
		i++;
        console.log ("foo: " + i);
	}


console.log (fn.toString ());
fn();


})();
